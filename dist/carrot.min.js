/*
 MIT
    2018 Bonsaiheldin
 @license      {@link https://github.com/bonsaiheldin/carrotJS/blob/master/LICENSE.md|MIT License}
*/
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var g=a[d];g in c||(c[g]={});c=c[g]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Math.hypot",function(a){return a?a:function(a,c,d){a=Number(a);c=Number(c);var b,e,f,h=Math.max(Math.abs(a),Math.abs(c));for(b=2;b<arguments.length;b++)h=Math.max(h,Math.abs(arguments[b]));if(1E100<h||1E-100>h){a/=h;c/=h;f=a*a+c*c;for(b=2;b<arguments.length;b++)e=Number(arguments[b])/h,f+=e*e;return Math.sqrt(f)*h}f=a*a+c*c;for(b=2;b<arguments.length;b++)e=Number(arguments[b]),f+=e*e;return Math.sqrt(f)}},"es6-impl","es3");
var Carrot={Version:"0.1",Game:function(a,b,c,d,g){var e=this;document.addEventListener("DOMContentLoaded",function(){e.width=a||800;e.height=b||600;e.parent=document.getElementById(c)||null;e.scene=d||null;e.transparent=g||!1;e.config={width:e.width,height:e.height,parent:e.parent,scene:e.scene,transparent:e.transparent};if(null===e.parent){var f=document.createElement("div");document.body.appendChild(f);f.className="carrotJS background";e.background=f;mainDiv=document.createElement("div");mainDiv.className=
"main";f.appendChild(mainDiv);e.parent=mainDiv}else f=document.createElement("div"),f.className="main",e.parent.appendChild(f),e.background=e.parent,e.parent=f;!1===e.transparent&&(e.background.style.backgroundColor="#000000");e.background.style.position="relative";e.background.style.width=e.width+"px";e.background.style.height=e.height+"px";e.background.style.overflow="hidden";e.background.style.fontFamily="sans-serif";e.background.style.boxSizing="border-box";e.parent.style.position="relative";
e.parent.style.width=e.width+"px";e.parent.style.height=e.height+"px";e.time=new Carrot.Time(e);e.debug=new Carrot.Debug(e);e.physics=new Carrot.Physics(e);e.math=new Carrot.Math(e);e.world=new Carrot.World(e);e.camera=new Carrot.Camera(e);e.cache=new Carrot.Cache(e);e.load=new Carrot.AssetLoader(e);e.add=new Carrot.ObjectFactory(e);e.sound=new Carrot.SoundManager(e);e.keyboard=new Carrot.Keyboard(e);e.mouse=new Carrot.Mouse(e);e.roundPixels=!1;if(null!==e.scene&&e.scene.preload){e.background.style.background=
"#0e1011 ";f=document.createElement("div");f.style.userSelect="none";f.style.pointerEvents="none";f.style.position="absolute";f.style.left="50%";f.style.top="50%";f.style.transform="translate(-50%, -50%)";f.style.textAlign="center";f.style.color="#eeeeee";f.style.fontSize="24px";f.style.lineHeight="24px";f.innerHTML='Made with <img src=\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64"><defs><linearGradient id="a"><stop offset="0" stop-color="%23ffdbc2"/><stop offset="1" stop-color="%23fff"/></linearGradient><linearGradient id="b"><stop offset="0" stop-color="%23fff"/><stop offset="1" stop-color="%23ffaa6e"/></linearGradient><linearGradient id="c"><stop offset="0" stop-color="%23ff2929"/><stop offset=".5" stop-color="%23f00000"/><stop offset="1" stop-color="%23820000"/></linearGradient><linearGradient id="d"><stop offset="0" stop-color="%23fff" stop-opacity=".771"/><stop offset="1" stop-color="%23fff" stop-opacity=".157"/></linearGradient></defs><path d="M44.268 12.869S46.504 2.734 47.236 1.27c.732-1.463 2.066-1.664 2.212-.859.146.806-1.943 9-2.437 9.714-.494.714.638 1.922 1.224 1.483.584-.439 3.55-8.377 4.574-9.145 1.024-.768 2.486-.035 2.486-.035s.822 1.555.054 2.36c-.769.805-3.477 6.95-5.123 7.498-1.645.548.657 1.794.657 1.794s4.72-5.596 6.657-6.363c1.938-.767 4.094-.327 3.308.606-.787.933.473 2.16-.623 2.525-1.097.365-6.29 4.716-6.967 4.88-.676.164-.11 1.683.657 1.794.768.11 6.363-5.23 7.515-5.064 1.151.166 2.576.24 2.448 1.137-.13.896-.696 2.122-2.232 2.816-1.535.694-7.385 2.337-8.518 2.958-1.134.622-9.153-5.366-8.86-6.5z" fill="%234cd600"/><path d="M367.137 604.92s-1.55-.1-2.102.864c-.55.963-3.403 5.89-3.224 7.009.18 1.119 1.543-.002 1.543-.002s4.886-5.271 5.13-6.213c.244-.943-.712-1.392-1.347-1.657z" fill="%23ffa000" stroke="%23e9621f" stroke-width=".406" transform="matrix(6.50417 1.39252 -1.39097 6.51142 -1499.653 -4435.396)"/><path d="M365.16 606.471s1.639-.893 2.41.772M364.578 607.708s1.476-.582 2.14.718M363.942 608.886s1.164-.556 1.841.555M363.373 610.104s1.124-.541 1.476.501M362.676 611.247s.866-.393 1.259.406" fill="none" stroke="%23f66000" stroke-width=".283" transform="matrix(6.50417 1.39252 -1.39097 6.51142 -1499.653 -4435.396)"/></svg>\' style=\'width: 32px; height: 32px; vertical-align: bottom;\'>carrotJS';
f.innerHTML+="<div><div></div></div>";f.innerHTML+="<font style='font-size: 16px;'>Loading ...</font>";var h=f.getElementsByTagName("div")[0];h.style.width="320px";h.style.height="24px";h.style.backgroundColor="#1d2124";h.style.borderRadius="12px";h.style.marginTop="8px";h.style.overflow="hidden";h=f.getElementsByTagName("div")[1];h.style.width="0%";h.style.height="100%";h.style.backgroundColor="#2c3135";h.style.transition="width 0.5s linear";e.background.appendChild(f);e.load.progressBar=h;e.scene.preload()}console.log("%c\ud83e\udd55 carrotJS v"+
Carrot.Version+" | HTML5 game engine utilizing the DOM | https://github.com/bonsaiheldin/carrotJS","font-weight: bold;");return e},!1)}};
Carrot.Game.prototype={start:function(a){MainLoop.setUpdate(function(b){a._update(b)}).setDraw(function(){a._render()}).start();null!==this.scene&&this.scene.create&&this.scene.create()},setCursor:function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);if(void 0===a)this.background.style.cursor="";else{var d=this.cache.images[a];this.background.style.cursor=void 0!==d?"url("+d.src+") "+b+" "+c+", default":a}},_update:function(a,b,c){this.time._update(a);this.world._update();this.camera._update();null!==
this.scene&&this.scene.update&&this.scene.update()},_render:function(a,b,c){this.world._render();this.camera._render();null!==this.scene&&this.scene.render&&this.scene.render()}};Carrot.Game.prototype.constructor=Carrot.Game;Carrot.World=function(a){this.game=a;this.camera=new Carrot.Camera(this.game);this.y=this.x=0;this.width=this.game.width;this.height=this.game.height;this.bounds=new Carrot.Rectangle(this.x,this.y,this.width,this.height);this.children=[];return this};
Carrot.World.prototype={addChild:function(a){a.parent!==this&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){this.children.splice(this.children.indexOf(a),1)},create:function(a,b,c,d,g){a=this.game.add.sprite(a||0,b||0,c||null,d||0,g||!1);this.addChild(a);return a},createMultiple:function(a,b,c,d,g,e){a=a||1;b=b||0;c=c||0;d=d||null;g=g||0;e=e||!1;for(var f=[],h=0;h<a;h++){var k=this.game.add.sprite(b,c,d,g,e);this.addChild(k);f.push(k)}return f},setSize:function(a,
b,c,d){this.y=this.x=0;this.width=c;this.height=d;void 0===a&&(this.x=0);void 0===b&&(this.y=0);void 0===c&&(this.width=800);void 0===d&&(this.height=600)},_update:function(){for(var a=0;a<this.children.length;a++){var b=this.children[a];b.active&&(b._update(),b.update&&b.update())}},_render:function(){for(var a=0;a<this.children.length;a++)this.children[a]._render()}};Carrot.World.prototype.constructor=Carrot.World;
Carrot.Camera=function(a){this.game=a;this.world=this.game.world;this.y=this.x=0;this.width=this.game.width;this.height=this.game.height;this.bounds=new Carrot.Rectangle(this.x,this.y,this.width,this.height);this.left=this.x;this.right=this.x+this.width;this.top=this.y;this.bottom=this.y+this.height;this.roundPixels=!1;this._x=this.x;this._y=this.y;this.target=null;return this};
Carrot.Camera.prototype={setSize:function(a,b){this.width=a;this.height=b;void 0===a&&(this.width=800);void 0===b&&(this.height=600)},follow:function(a){a&&(this.target=a)},unfollow:function(){this.target=null},_update:function(){if(null!==this.target){this._x=this.x;this._y=this.y;var a=this.target.x,b=this.target.y,c=.5*this.width,d=.5*this.height;a>c&&a<=this.world.width-c&&(this.x=a-.5*this.width);b>d&&b<=this.world.height-d&&(this.y=b-d)}if(this.game.roundPixels||this.roundPixels)this.x=Math.round(this.x),
this.y=Math.round(this.y);this.left=this.x;this.right=this.left+this.width;this.top=this.y;this.bottom=this.top+this.height},_render:function(){if(this.x!==this._x||this.y!==this._y)this.game.parent.style.left=-this.x+"px",this.game.parent.style.top=-this.y+"px"}};Carrot.Camera.prototype.constructor=Carrot.Camera;
Carrot.Group=function(a){this.game=a;this.world=this.game.world;this.physicsEnabled=!1;this.type=Carrot.GROUP;this.active=!0;this.parent=this.world;this.children=[];this.inactives=[];this.parent.addChild(this);return this};
Carrot.Group.prototype={addChild:function(a){a.parent!==this&&a.parent.removeChild(a);a.active?this.children.push(a):this.inactives.push(a);a.parent=this},removeChild:function(a){a.active?this.children.splice(this.children.indexOf(a),1):this.inactives.splice(this.inactives.indexOf(a),1)},setAll:function(a,b,c){a=a.split(".");void 0===c&&(c=!0);var d=a[0]||"",g=a[1]||"";a=a[2]||"";var e=this.children;!1===c&&(e=this.inactives);for(c=0;c<e.length;c++){var f=e[c];void 0!==f[d]&&(void 0!==f[d][g]?void 0!==
f[d][g][a]?f[d][g][a]=b:f[d][g]=b:f[d]=b)}},create:function(a,b,c,d,g){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=null);void 0===d&&(d=0);void 0===g&&(g=!1);a=this.game.add.sprite(a,b,c,d,g);this.physicsEnabled&&app.game.physics.enable(a);this.addChild(a);return a},createMultiple:function(a,b,c,d,g,e){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);void 0===d&&(d=null);void 0===g&&(g=0);void 0===e&&(e=!1);for(var f=[],h=0;h<a;h++){var k=this.game.add.sprite(b,c,d,g,e);this.physicsEnabled&&
app.game.physics.enable(k);this.addChild(k);f.push(k)}return f},getInactive:function(a,b,c,d,g){void 0===a&&(a=!1);void 0===b&&(b=0);void 0===c&&(c=0);void 0===d&&(d=null);void 0===g&&(g=0);for(var e=0;e<this.inactives.length;e++){var f=this.inactives[e];if(!1===f.active)return f.x=b,f.y=c,f.key=d,f.frame=0,f}return a?this.create(b,c,d,g,!1):null},countInactive:function(){for(var a=0,b=0;b<this.children.length;b++)!1===this.children[b].active&&(a+=1);return a},countActive:function(){for(var a=0,b=
0;b<this.children.length;b++)!0===this.children[b].active&&(a+=1);return a},destroy:function(a){for(var b=0;b<this.children.length;b++){var c=this.children[b];a?c.destroy(!0):this.removeChild(c)}this.active=!1;this.parent.removeChild(this)},_update:function(){for(var a=0;a<this.children.length;a++){var b=this.children[a];b.active&&(b._update(),b.update&&b.update())}},_render:function(){for(var a=0;a<this.children.length;a++)this.children[a]._render()}};Carrot.Group.prototype.constructor=Carrot.Group;
Carrot.Sprite=function(a,b,c,d,g,e){this.x=b;this.y=c;this.key=d;this.frame=g;this.active=e;void 0===b&&(this.x=0);void 0===c&&(this.y=0);void 0===d&&(this.key=null);void 0===g&&(this.frame=0);void 0===e&&(this.active=!0);this.game=a;this.world=this.game.world;this.camera=this.game.camera;this.time=this.game.time;this.type=Carrot.SPRITE;this.parent=this.world;this.children=[];this.alpha=1;this.height=this.width=32;this.anchor=new Carrot.Point(0,0);this.left=this.x-this.width*this.anchor.x;this.right=
this.left+this.width;this.top=this.y-this.height*this.anchor.y;this.bottom=this.top+this.height;this.inCamera=this.outOfBoundsKill=!1;this.css={};this.css.transform="";this.angle=0;this.roundPixels=!1;this._x=this.x;this._y=this.y;this._angle=this.angle;this._alpha=this.alpha;this.style=this.image=this.body=null;this.visible=!0;this.active&&this.revive();this.parent.addChild(this);this.name="Unknown sprite";return this};
Carrot.Sprite.prototype={createNode:function(){if(null===this.image){var a=document.createElement("div");this.image=a;this.style=this.image.style;this.image.style.position="absolute";this.image.style.width="32px";this.image.style.height="32px";this.image.style.backgroundSize="cover";if(null!==this.key){var b=this.game.cache.images[this.key];this.style.backgroundImage="url("+b.src+")";this.width=b.width;this.height=b.height;this.image.style.width=this.width+"px";this.image.style.height=this.height+
"px";0!==this.frame&&(b=b.frames[this.frame],this.image.style.backgroundPosition=b.x+"px "+b.y+"px")}this.image.style.left=this.x-.5*this.width+"px";this.image.style.top=this.y-.5*this.height+"px";this.game.parent.appendChild(this.image);return a}},destroyNode:function(){null!==this.image&&(this.image.parentNode.removeChild(this.image),this.style=this.image=null)},addChild:function(a){null!==a.image&&(this.game.parent.removeChild(a.image),this.image.appendChild(a.image),a.image.style.left=a.x-a.width*
a.anchor.x+"px",a.image.style.top=a.y-a.height*a.anchor.y+"px");a.parent!==this&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){this.image.removeChild(a.image);this.game.parent.appendChild(a.image);this.children.splice(this.children.indexOf(a),1)},kill:function(a){this.parent.removeChild(this);this.visible=this.active=!1;this.parent.addChild(this);a&&this.destroyNode()},revive:function(){this.parent.removeChild(this);this.visible=this.active=!0;this.parent.addChild(this);
this.createNode()},destroy:function(a){a=a||!1;for(var b=0;b<this.children.length;b++){var c=this.children[b];a?c.destroy(!0):this.removeChild(c)}this.parent.removeChild(this);this.destroyNode()},setFrame:function(a){a=this.game.cache.images[this.key].frames[a||0];this.image.style.backgroundPosition=a.x+"px "+a.y+"px"},setGlow:function(a,b,c,d){!1!==a?(c=c||Carrot.Color.Lime,this.image.style.boxShadow="0px 0px "+((a||0)+"px ")+((b||0)+"px ")+c+(d?" inset":"")):void 0===a&&(this.image.style.boxShadow=
"")},update:function(){},_update:function(){this._x=this.x;this._y=this.y;this._angle=this.angle;this._alpha=this.alpha;var a=this.world.width,b=this.world.height;this.inCamera=!1;this.right>this.camera.left&&this.bottom>this.camera.top&&this.left<this.camera.right&&this.top<this.camera.bottom&&(this.inCamera=!0);if(null!==this.body&&this.body.enabled){this.body.touching.none=!0;this.body.touching.left=!1;this.body.touching.right=!1;this.body.touching.top=!1;this.body.touching.bottom=!1;0!==this.body.angularVelocity&&
(this.angle+=this.body.angularVelocity*this.time.delta);this.body.allowAngularDrag&&0<this.body.angularDrag&&(this.angle+=1-this.body.angularDrag);this.body.allowAcceleration&&(this.body.velocity.x+=this.body.acceleration.x*this.time.delta,this.body.velocity.y+=this.body.acceleration.y*this.time.delta);this.body.allowGravity&&(this.body.velocity.x+=this.body.gravity.x*this.time.delta,this.body.velocity.y+=this.body.gravity.y*this.time.delta);this.body.allowDrag&&(this.body.velocity.x*=1-this.body.drag.x,
this.body.velocity.y*=1-this.body.drag.y);var c=this.body.maxVelocity.x,d=this.body.maxVelocity.y;this.body.velocity.x>c?this.body.velocity.x=c:this.body.velocity.x<-c&&(this.body.velocity.x=-c);this.body.velocity.y>d?this.body.velocity.y=d:this.body.velocity.y<-d&&(this.body.velocity.y=-d);this.x+=this.body.velocity.x*this.time.delta;this.y+=this.body.velocity.y*this.time.delta;if(this.game.roundPixels||this.roundPixels)this.x=Math.round(this.x),this.y=Math.round(this.y);this.body.collideWorldBounds&&
(this.x<=this.width?(this.x=this.width,this.body.touching.none=!1,this.body.touching.left=!0,this.body.allowBounce&&(this.body.velocity.x=-(this.body.velocity.x*this.body.bounce.x))):this.x+this.width>=a&&(this.x=a-this.width,this.body.touching.none=!1,this.body.touching.right=!0,this.body.allowBounce&&(this.body.velocity.x=-(this.body.velocity.x*this.body.bounce.x))),this.y<=this.height?(this.y=this.height,this.body.touching.none=!1,this.body.touching.top=!0,this.body.allowBounce&&(this.body.velocity.y=
-(this.body.velocity.y*this.body.bounce.y))):this.y+this.height>=b&&(this.y=b-this.height,this.body.touching.none=!1,this.body.touching.bottom=!0,this.body.allowBounce&&(this.body.velocity.y=-(this.body.velocity.y*this.body.bounce.y))))}this.outOfBoundsKill&&(0>this.left||this.right>a||0>this.top||this.bottom>b)&&this.kill(!0);this.left=this.x;this.right=this.x+this.width;this.top=this.y;this.bottom=this.y+this.height;this.css.transform="";0!==this.angle&&(this.css.transform+=" rotate("+this.angle+
"deg) ");for(a=0;a<this.children.length;a++)b=this.children[a],b.active&&(b._update(),b.update&&b.update())},_render:function(){if(this.active){!1===this.inCamera?!0===this.visible&&(this.visible=!1,this.style.display="none"):(!1===this.visible&&(this.visible=!0,this.style.display=""),this.alpha!==this._alpha&&1>this.alpha&&(this.style.opacity=this.alpha),this.x!==this._x&&(this.image.style.left=this.x-this.width*this.anchor.x+"px"),this.y!==this._y&&(this.image.style.top=this.y-this.height*this.anchor.y+
"px"),this.style.transform=this.css.transform);for(var a=0;a<this.children.length;a++)this.children[a]._render()}}};Carrot.Sprite.prototype.constructor=Carrot.Sprite;Carrot.Time=function(a){this.game=a;this.lastFrame=this.now=performance.now();this.delta=1E3/60;this.timers=[];return this};Carrot.Time.prototype={_update:function(a){this.lastFrame=this.now;this.now=performance.now();this.lastFrame=this.now-this.lastFrame;this.delta=a/1E3;for(a=0;a<this.timers.length;a++)this.timers[a]._update(this.lastFrame)}};
Carrot.Time.prototype.constructor=Carrot.Time;
Carrot.Timer=function(a,b,c,d,g){this.game=a;this.time=this.game.time;this.delay=b;this.callback=c;this.timesToRepeat=d;this.startNow=g;void 0===this.delay&&(this.delay=0);void 0===this.callback&&(this.callback=function(){});void 0===this.timesToRepeat&&(this.timesToRepeat=0);void 0===this.startNow&&(this.startNow=!0);this.startTime=this.time.now;this.endTime=this.startTime+this.delay;this.timesExecuted=0;this.isRunning=!0;!1===this.startNow&&(this.isRunning=!1);this.time.timers.push(this);return this};
Carrot.Timer.prototype={start:function(){this.isRunning=!0},stop:function(){this.isRunning=!1},resume:function(){this.isRunning=!0},destroy:function(){this.time.timers.splice(this.time.timers.indexOf(this),1)},_update:function(){this.isRunning&&this.time.now>=this.endTime&&(this.callback(),this.timesExecuted+=1,-1!==this.timesToRepeat&&this.timesExecuted>this.timesToRepeat?this.destroy():this.endTime=this.time.now+this.delay)}};Carrot.Timer.prototype.constructor=Carrot.Timer;
Carrot.Math=function(a){this.game=a;return this};
Carrot.Math.prototype={PI:Math.PI,PI2:2*Math.PI,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,degToRad:function(a){return a*this.DEG_TO_RAD},radToDeg:function(a){return a*this.RAD_TO_DEG},integerInRange:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},angleBetweenPoints:function(a,b,c,d){return Math.atan2(d-b,c-a)},angleBetween:function(a,b){return Math.atan2(b.y-a.y,b.x-a.x)},distanceBetweenPoints:function(a,b,c,d){return Math.hypot(c-a,d-b)},distanceBetween:function(a,b){return Math.hypot(b.x-
a.x,b.y-a.y)}};Carrot.Math.prototype.constructor=Carrot.Math;Carrot.SoundManager=function(a){this.game=a;return this};Carrot.SoundManager.prototype={play:function(a,b){a=this.game.cache.sounds[a];a.paused||(a.pause(),a.currentTime=0);a.play();void 0!==b&&(a.loop=b)}};Carrot.SoundManager.prototype.constructor=Carrot.SoundManager;Carrot.Physics=function(a){this.game=a;this.time=this.game.time;return this};
Carrot.Physics.prototype={enable:function(a){null===a.body&&(a.body=new Carrot.Physics.Body(a))},disable:function(a){null!==a.body&&(a.body=null)},collide:function(a,b,c){c=c||null;a.type===Carrot.SPRITE?b.type===Carrot.SPRITE?this.collideSpriteVsSprite(a,b,c):b.type===Carrot.GROUP&&this.collideSpriteVsGroup(a,b,c):a.type===Carrot.GROUP&&(b.type===Carrot.SPRITE?this.collideSpriteVsGroup(b,a,c):b.type===Carrot.GROUP&&this.collideGroupVsGroup(a,b,c))},overlap:function(a,b,c){c=c||null;a.type===Carrot.SPRITE?
b.type===Carrot.SPRITE?this.collideSpriteVsSprite(a,b,c,!0):b.type===Carrot.GROUP&&this.collideSpriteVsGroup(a,b,c,!0):a.type===Carrot.GROUP&&(b.type===Carrot.SPRITE?this.collideSpriteVsGroup(b,a,c,!0):b.type===Carrot.GROUP&&this.collideGroupVsGroup(a,b,c,!0))},collideGroupVsGroup:function(a,b,c,d){c=c||null;for(d=0;d<a.children.length;d++)for(var g=a.children[d],e=0;e<b.children.length;e++){var f=b.children[e];f!==g&&(!0===g.body.isRectangle?!0===f.body.isRectangle?this.intersectRectangleVsRectangle(g,
f)&&null!==c&&c(g,f):!0===f.body.isCircle&&this.intersectRectangleVsCircle(g,f)&&null!==c&&c(g,f):!0===g.body.isCircle&&(!0===f.body.isCircle?this.intersectCircleVsCircle(g,f)&&null!==c&&c(g,f):!0===g.body.isRectangle&&this.intersectRectangleVsCircle(f,g)&&null!==c&&c(g,f)))}},collideSpriteVsGroup:function(a,b,c,d){c=c||null;for(d=0;d<b.children.length;d++){var g=b.children[d];g!==a&&(!0===a.body.isRectangle?!0===g.body.isRectangle?this.intersectRectangleVsRectangle(a,g)&&null!==c&&c(a,g):!0===g.body.isCircle&&
this.intersectRectangleVsCircle(a,g)&&null!==c&&c(a,g):!0===a.body.isCircle&&(!0===g.body.isCircle?this.intersectCircleVsCircle(a,g)&&null!==c&&c(a,g):!0===a.body.isRectangle&&this.intersectRectangleVsCircle(g,a)&&null!==c&&c(a,g)))}},collideSpriteVsSprite:function(a,b,c,d){c=c||null;b!==a&&(!0===a.body.isRectangle?!0===b.body.isRectangle?this.intersectRectangleVsRectangle(a,b)&&null!==c&&c(a,b):!0===b.body.isCircle&&this.intersectRectangleVsCircle(a,b)&&null!==c&&c(a,b):!0===a.body.isCircle&&(!0===
b.body.isCircle?this.intersectCircleVsCircle(a,b)&&null!==c&&c(a,b):!0===a.body.isRectangle&&this.intersectRectangleVsCircle(b,a)&&null!==c&&c(a,b)))},intersectRectangleVsRectangle:function(a,b){return a.left>b.right||a.right<b.left||a.top>b.bottom||a.bottom<b.top?!1:!0},intersectCircleVsCircle:function(a,b){var c=a.x-b.x,d=a.y-b.y,g=.5*a.width+.5*b.width;return c*c+d*d<g*g},intersectRectangleVsCircle:function(a,b){var c=.5*b.width,d=b.width-c,g=b.height-c,e=a.width,f=a.height,h=f-.5*f,d=d-Math.max(e-
.5*e,Math.min(d,h+e)),g=g-Math.max(h,Math.min(g,h+f));return d*d+g*g<c*c}};Carrot.Physics.prototype.constructor=Carrot.Physics;
Carrot.Physics.Body=function(a,b,c){this.parent=a;this.x=b||0;this.y=c||0;this.velocity=new Carrot.Point(0,0);this.bounce=new Carrot.Point(0,0);this.drag=new Carrot.Point(0,0);this.gravity=new Carrot.Point(0,0);this.acceleration=new Carrot.Point(0,0);this.maxVelocity=new Carrot.Point(1E4,1E4);this.angularDrag=this.angularVelocity=0;this.allowAngularDrag=this.allowAcceleration=this.allowGravity=this.allowDrag=this.allowBounce=!0;this.touching={none:!0,left:!1,right:!1,top:!1,bottom:!1};this.collideWorldBounds=
!1;this.isRectangle=!0;this.isCircle=!1;this.enabled=!0;return this};Carrot.Physics.Body.prototype={setCircle:function(){this.isRectangle=!1;this.isCircle=!0;this.sprite.style.borderRadius=.5*this.sprite.width+"px"},setRectangle:function(){this.isRectangle=!0;this.isCircle=!1;this.sprite.image.style.borderRadius=""}};Carrot.Physics.Body.prototype.constructor=Carrot.Physics.Body;Carrot.Cache=function(a){this.game=a;this.images={};this.sounds={};this.json={};this.csv={};this.classes={}};
Carrot.Cache.prototype={};Carrot.Cache.prototype.constructor=Carrot.Cache;Carrot.Entity=function(a,b,c){this.game=a;this.name=b;this.css=c||{};return this};Carrot.Entity.prototype={add:function(a,b){a&&(b=b||null,this.game.cache.classes[a]=null!==b?b:{})},remove:function(a){delete this.game.cache.classes[a]},edit:function(a,b,c){(a=this.game.cache.classes[a])&&(a[b]=c)}};Carrot.Entity.prototype.constructor=Carrot.Entity;Carrot.Point=function(a,b){a=a||0;this.setTo(a,b||a);return this};
Carrot.Point.prototype={setTo:function(a,b){this.x=a||0;this.y=b||0}};Carrot.Point.prototype.constructor=Carrot.Point;Carrot.Line=function(a,b,c,d){this.end=this.start=null;this.setTo(a||0,b||0,c||0,d||0);return this};Carrot.Line.prototype={setTo:function(a,b,c,d){this.start=new Carrot.Point(a,b);this.end=new Carrot.Point(c,d)}};Carrot.Line.prototype.constructor=Carrot.Line;Carrot.Rectangle=function(a,b,c,d){this.setTo(a||0,b||0,c||0,d||0);return this};
Carrot.Rectangle.prototype={setTo:function(a,b,c,d){this.x=a||0;this.y=b||0;this.width=c||0;this.height=d||0}};Carrot.Rectangle.prototype.constructor=Carrot.Rectangle;Carrot.Circle=function(a,b,c){this.setTo(a||0,b||0,c||0);return this};Carrot.Circle.prototype={setTo:function(a,b,c){this.x=a||0;this.y=b||a;this.diameter=c||0;this.radius=.5*c}};Carrot.Circle.prototype.constructor=Carrot.Circle;Carrot.ObjectFactory=function(a){this.game=a;return this};
Carrot.ObjectFactory.prototype={sprite:function(a,b,c,d,g){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=null);void 0===d&&(d=0);void 0===g&&(g=!0);return new Carrot.Sprite(this.game,a,b,c,d,g)},group:function(){return new Carrot.Group(this.game)},timer:function(a,b,c,d){return new Carrot.Timer(this.game,a,b,c,d)}};Carrot.ObjectFactory.prototype.constructor=Carrot.ObjectFactory;Carrot.AssetLoader=function(a){this.game=a;this.filesToLoad=this.filesLoaded=0;return this};
Carrot.AssetLoader.prototype={image:function(a,b){var c=this,d=document.createElement("img");d.src=b;d.onload=function(b){d.onload=null;d.onerror=null;c.fileLoaded(a)};d.onerror=function(b){delete c.game.cache.images[a]};this.game.cache.images[a]=d;this.filesToLoad+=1},spritesheet:function(a,b,c,d,g){c=c||32;d=d||32;g=g||Infinity;var e=this,f=document.createElement("img");f.src=b;f.onload=function(b){b=[];for(var h=0,l=0;l<e.width;l+=c)for(var m=0;m<e.height;m+=d){h+=1;if(h===g)break;b.push({x:-l,
y:-m})}e.game.cache.images[a].frames=b;f.onload=null;f.onerror=null;e.fileLoaded(a)};f.onerror=function(b){delete e.game.cache.images[a]};this.game.cache.images[a]=f;this.game.cache.images[a].frames=[];this.game.cache.images[a].frameWidth=c;this.game.cache.images[a].frameHeight=d;this.filesToLoad+=1},sound:function(a,b){var c=this,d=document.createElement("audio");d.src=b;d.oncanplaythrough=function(b){d.oncanplaythrough=null;d.onerror=null;c.fileLoaded(a)};d.onerror=function(b){delete c.game.cache.sounds[a]};
this.game.cache.sounds[a]=d;this.filesToLoad+=1},json:function(a,b){var c=this,d=new XMLHttpRequest;d.onload=function(b){c.game.cache.json[a]=JSON.parse(this.responseText);c.fileLoaded(a)};d.onerror=function(b){delete this.game.cache.json[a]};d.open("GET",window.location.href+"/"+b,!0);d.send();this.game.cache.json[a]={};this.filesToLoad+=1},csv:function(a,b){var c=this,d=new XMLHttpRequest;d.onload=function(b){b={};for(var d=this.responseText.split(/\n|\r/),f=d[0].replace(/['"]+/g,""),f=f.replace(/\s/g,
""),f=f.split(","),g=1;g<d.length;g++){var k=d[g].split(","),l=k[0],l=l.trim();if(""!==l){b[l]={};for(var m=1;m<f.length;m++){var q=f[m],n=parseInt(k[m]);isNaN(n)&&(n=k[m].replace(/['"]+/g,""));b[l][q]=n}}}c.game.cache.csv[a]=b;c.fileLoaded(a)};d.onerror=function(b){delete this.game.cache.csv[a]};d.open("GET",window.location.href+"/"+b,!0);d.send();this.game.cache.csv[a]={};this.filesToLoad+=1},fileLoaded:function(a){this.filesLoaded+=1;this.progressBar&&(this.progressBar.style.width=this.filesLoaded/
this.filesToLoad*100+"%");this.checkFilesLoaded()},checkFilesLoaded:function(){this.filesToLoad===this.filesLoaded&&this.progressBar&&(this.progressBar.parentNode.parentNode.remove(),delete this.progressBar,!1===this.game.transparent?this.game.background.style.backgroundColor="#000000":this.game.background.style.background="",this.game.start(this.game))}};Carrot.AssetLoader.prototype.constructor=Carrot.AssetLoader;
Carrot.Keyboard=function(a){this.isDown={};this.isPressed={};this.isUp={};this.game=a;for(a=0;200>a;a++)this.isDown[a]=!1,this.isPressed[a]=!1,this.isUp[a]=!1;var b=this;window.addEventListener("keydown",function(a){b.isDown[a.keyCode]=!0},!1);window.addEventListener("keypress",function(a){b.isPressed[a.keyCode]=!0},!1);window.addEventListener("keyup",function(a){b.isDown[a.keyCode]=!1;b.isPressed[a.keyCode]=!1;b.isUp[a.keyCode]=!0},!1);return this};
Carrot.Keyboard.prototype={isDown:function(a){},isUp:function(a){}};Carrot.Keyboard.prototype.constructor=Carrot.Keyboard;
Carrot.KeyCode={A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,
F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,COMMA:188,UNDERSCORE:189,PERIOD:190,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:43,MINUS:44,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144};
for(var key in Carrot.KeyCode)Carrot.KeyCode.hasOwnProperty(key)&&!key.match(/[a-z]/)&&(Carrot.Keyboard[key]=Carrot.KeyCode[key]);
Carrot.Color={AliceBlue:"#F0F8FF",AntiqueWhite:"#FAEBD7",Aqua:"#00FFFF",Aquamarine:"#7FFFD4",Azure:"#F0FFFF",Beige:"#F5F5DC",Bisque:"#FFE4C4",Black:"#000000",BlanchedAlmond:"#FFEBCD",Blue:"#0000FF",BlueViolet:"#8A2BE2",Brown:"#A52A2A",BurlyWood:"#DEB887",CadetBlue:"#5F9EA0",Chartreuse:"#7FFF00",Chocolate:"#D2691E",Coral:"#FF7F50",CornflowerBlue:"#6495ED",Cornsilk:"#FFF8DC",Crimson:"#DC143C",Cyan:"#00FFFF",DarkBlue:"#00008B",DarkCyan:"#008B8B",DarkGoldenRod:"#B8860B",DarkGray:"#A9A9A9",DarkGrey:"#A9A9A9",
DarkGreen:"#006400",DarkKhaki:"#BDB76B",DarkMagenta:"#8B008B",DarkOliveGreen:"#556B2F",DarkOrange:"#FF8C00",DarkOrchid:"#9932CC",DarkRed:"#8B0000",DarkSalmon:"#E9967A",DarkSeaGreen:"#8FBC8F",DarkSlateBlue:"#483D8B",DarkSlateGray:"#2F4F4F",DarkSlateGrey:"#2F4F4F",DarkTurquoise:"#00CED1",DarkViolet:"#9400D3",DeepPink:"#FF1493",DeepSkyBlue:"#00BFFF",DimGray:"#696969",DimGrey:"#696969",DodgerBlue:"#1E90FF",FireBrick:"#B22222",FloralWhite:"#FFFAF0",ForestGreen:"#228B22",Fuchsia:"#FF00FF",Gainsboro:"#DCDCDC",
GhostWhite:"#F8F8FF",Gold:"#FFD700",GoldenRod:"#DAA520",Gray:"#808080",Grey:"#808080",Green:"#008000",GreenYellow:"#ADFF2F",HoneyDew:"#F0FFF0",HotPink:"#FF69B4",IndianRed:"#CD5C5C",Indigo:"#4B0082",Ivory:"#FFFFF0",Khaki:"#F0E68C",Lavender:"#E6E6FA",LavenderBlush:"#FFF0F5",LawnGreen:"#7CFC00",LemonChiffon:"#FFFACD",LightBlue:"#ADD8E6",LightCoral:"#F08080",LightCyan:"#E0FFFF",LightGoldenRodYellow:"#FAFAD2",LightGray:"#D3D3D3",LightGrey:"#D3D3D3",LightGreen:"#90EE90",LightPink:"#FFB6C1",LightSalmon:"#FFA07A",
LightSeaGreen:"#20B2AA",LightSkyBlue:"#87CEFA",LightSlateGray:"#778899",LightSlateGrey:"#778899",LightSteelBlue:"#B0C4DE",LightYellow:"#FFFFE0",Lime:"#00FF00",LimeGreen:"#32CD32",Linen:"#FAF0E6",Magenta:"#FF00FF",Maroon:"#800000",MediumAquaMarine:"#66CDAA",MediumBlue:"#0000CD",MediumOrchid:"#BA55D3",MediumPurple:"#9370DB",MediumSeaGreen:"#3CB371",MediumSlateBlue:"#7B68EE",MediumSpringGreen:"#00FA9A",MediumTurquoise:"#48D1CC",MediumVioletRed:"#C71585",MidnightBlue:"#191970",MintCream:"#F5FFFA",MistyRose:"#FFE4E1",
Moccasin:"#FFE4B5",NavajoWhite:"#FFDEAD",Navy:"#000080",OldLace:"#FDF5E6",Olive:"#808000",OliveDrab:"#6B8E23",Orange:"#FFA500",OrangeRed:"#FF4500",Orchid:"#DA70D6",PaleGoldenRod:"#EEE8AA",PaleGreen:"#98FB98",PaleTurquoise:"#AFEEEE",PaleVioletRed:"#DB7093",PapayaWhip:"#FFEFD5",PeachPuff:"#FFDAB9",Peru:"#CD853F",Pink:"#FFC0CB",Plum:"#DDA0DD",PowderBlue:"#B0E0E6",Purple:"#800080",RebeccaPurple:"#663399",Red:"#FF0000",RosyBrown:"#BC8F8F",RoyalBlue:"#4169E1",SaddleBrown:"#8B4513",Salmon:"#FA8072",SandyBrown:"#F4A460",
SeaGreen:"#2E8B57",SeaShell:"#FFF5EE",Sienna:"#A0522D",Silver:"#C0C0C0",SkyBlue:"#87CEEB",SlateBlue:"#6A5ACD",SlateGray:"#708090",SlateGrey:"#708090",Snow:"#FFFAFA",SpringGreen:"#00FF7F",SteelBlue:"#4682B4",Tan:"#D2B48C",Teal:"#008080",Thistle:"#D8BFD8",Tomato:"#FF6347",Turquoise:"#40E0D0",Violet:"#EE82EE",Wheat:"#F5DEB3",White:"#FFFFFF",WhiteSmoke:"#F5F5F5",Yellow:"#FFFF00",YellowGreen:"#9ACD32"};
Carrot.Mouse=function(a){this.wheel=this.worldY=this.worldX=this.y=this.x=0;this.isDown=[];this.isUp=[];this.game=a;a=this.game.background;var b=this;a.addEventListener("mousemove",function(a){b.x=a.offsetX;b.y=a.offsetY;b.worldX=b.x+b.game.camera.x;b.worldY=b.y+b.game.camera.y},!0);a.addEventListener("mousedown",function(a){b.isDown[a.button]=!0;b.isUp[a.button]=!1},!0);a.addEventListener("mouseup",function(a){b.isDown[a.button]=!1;b.isUp[a.button]=!0},!0);return this};Carrot.Mouse.LEFT_BUTTON=0;
Carrot.Mouse.MIDDLE_BUTTON=1;Carrot.Mouse.RIGHT_BUTTON=2;Carrot.Mouse.prototype={onMouseMove:function(a){this.x=a.offsetX;this.y=a.offsetY},onMouseDown:function(a){this.isDown[a.button]=!0;this.isUp[a.button]=!1},onMouseUp:function(a){this.isDown[a.button]=!1;this.isUp[a.button]=!0}};Carrot.Mouse.prototype.constructor=Carrot.Mouse;Carrot.Debug=function(a){this.game=a;return this};
Carrot.Debug.prototype={sprite:function(a,b,c){if(void 0!==a&&(void 0===b&&(b="rgba(0, 255, 0, 0.33)"),void 0===c&&(c=!1),a.image)){var d=a.image.getElementsByClassName("debugSprite")[0];void 0===d&&(d=document.createElement("div"),a.image.insertBefore(d,a.image.firstChild),d.className="debugSprite",d.style.height="100%",c?d.style.border="1px solid "+b:d.style.backgroundColor=b)}},spriteInfo:function(a,b,c){if(void 0!==a){void 0===b&&(b=0);void 0===c&&(c=0);var d=this.game.background.getElementsByClassName("debugSpriteInfo")[0];
void 0!==d?d.innerHTML="<strong>Sprite:</strong><br>x: "+Math.round(10*a.x)/10+" y: "+Math.round(10*a.x)/10+" angle: "+Math.round(10*a.angle)/10+" anchor: "+Math.round(10*a.anchor.x)/10+" x "+Math.round(10*a.anchor.y)/10+"<br>bounds: { left: "+a.left+", top: "+a.top+", right: "+a.right+", bottom: "+a.bottom+' }<br>key: "'+a.key+'" width: '+a.width+" height: "+a.height+" frame: "+a.frame+"<br>active: "+a.active+" inCamera: "+a.inCamera+" visible: "+a.visible:(d=document.createElement("div"),this.game.background.appendChild(d),
d.className="debugSpriteInfo",d.style.position="absolute",d.style.left=b+"px",d.style.top=c+"px",d.style.color="#ffffff",d.style.fontSize="16px",d.style.lineHeight="20px",d.style.textShadow="1px 1px 0px #111111",d.style.userSelect="none",d.style.pointerEvents="none")}},cameraInfo:function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);var c=this.game.background.getElementsByClassName("debugCameraInfo")[0];if(void 0!==c){var d=app.game.camera;c.innerHTML="<strong>Camera:</strong><br>x: "+Math.round(10*d.x)/
10+" y: "+Math.round(10*d.x)/10+" width: "+d.width+" height: "+d.height}else c=document.createElement("div"),this.game.background.appendChild(c),c.className="debugCameraInfo",c.style.position="absolute",c.style.left=a+"px",c.style.top=b+"px",c.style.color="#ffffff",c.style.fontSize="16px",c.style.lineHeight="20px",c.style.textShadow="1px 1px 0px #111111",c.style.userSelect="none",c.style.pointerEvents="none"},text:function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);var d=this.game.background.getElementsByClassName("debugText")[0];
void 0!==d?d.innerHTML=a:(d=document.createElement("div"),this.game.background.appendChild(d),d.className="debugText",d.style.position="absolute",d.style.left=b+"px",d.style.top=c+"px",d.style.color="#ffffff",d.style.fontSize="16px",d.style.lineHeight="20px",d.style.textShadow="1px 1px 0px #111111",d.style.userSelect="none",d.style.pointerEvents="none")}};Carrot.Debug.prototype.constructor=Carrot.Debug;Carrot.SPRITE=0;Carrot.GROUP=1;
!function(a){function b(a){if(r=u(b),!(a<g+q)){d+=a-g;g=a;v(a,d);a>k+h&&(e=f*l*1E3/(a-k)+(1-f)*e,k=a,l=0);l++;for(m=0;d>=c;)if(w(c),d-=c,240<=++m){x=!0;break}t(d/c);y(e,x);x=!1}}var c=1E3/60,d=0,g=0,e=60,f=.9,h=1E3,k=0,l=0,m=0,q=0,n=!1,z=!1,x=!1,p="object"==typeof window?window:a,u=p.requestAnimationFrame||function(){var a=Date.now(),b,d;return function(e){return b=Date.now(),d=Math.max(0,c-(b-a)),a=b+d,setTimeout(function(){e(b+d)},d)}}(),A=p.cancelAnimationFrame||clearTimeout,v=p=function(){},w=
p,t=p,y=p,r;a.MainLoop={getSimulationTimestep:function(){return c},setSimulationTimestep:function(a){return c=a,this},getFPS:function(){return e},getMaxAllowedFPS:function(){return 1E3/q},setMaxAllowedFPS:function(a){return"undefined"==typeof a&&(a=1/0),0===a?this.stop():q=1E3/a,this},resetFrameDelta:function(){var a=d;return d=0,a},setBegin:function(a){return v=a||v,this},setUpdate:function(a){return w=a||w,this},setDraw:function(a){return t=a||t,this},setEnd:function(a){return y=a||y,this},start:function(){return z||
(z=!0,r=u(function(a){t(1);n=!0;k=g=a;l=0;r=u(b)})),this},stop:function(){return n=!1,z=!1,A(r),this},isRunning:function(){return n}};"function"==typeof define&&define.amd?define(a.MainLoop):"object"==typeof module&&null!==module&&"object"==typeof module.exports&&(module.exports=a.MainLoop)}(this);
